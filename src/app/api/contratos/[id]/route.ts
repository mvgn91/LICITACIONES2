import { sql } from \'@vercel/postgres\';\nimport { NextResponse } from \'next/server\';\n\nexport async function GET(request: Request, { params }: { params: { id: string } }) {\n    try {\n        const { id } = params;\n        const { rows } = await sql`\n            SELECT \n                id, nombre, cliente, estado, descripcion,\n                fecha_inicio AS \"fechaInicio\",  \n                fechafin AS \"fechaFin\", -- CORREGIDO\n                fecha_termino_estimada AS \"fechaTerminoEstimada\",\n                monto_base AS \"montoBase\",\n                monto_total AS \"montoConIVA\",\n                anticipo_monto AS \"anticipoMonto\",\n                anticipo_fecha AS \"anticipoFecha\"\n            FROM contratos WHERE id = ${id};\n        `;\n        if (rows.length === 0) {\n            return NextResponse.json({ error: \'Contract not found\' }, { status: 404 });\n        }\n        return NextResponse.json({ contrato: rows[0] });\n    } catch (error) {\n        console.error(\'Error fetching contract:\', error);\n        return NextResponse.json({ error: (error as Error).message }, { status: 500 });\n    }\n}\n\nexport async function PUT(request: Request, { params }: { params: { id: string } }) {\n    try {\n        const { id } = params;\n        const { \n          nombre, cliente, descripcion, estado, \n          fechaInicio, fechaFin, fechaTerminoEstimada, \n          montoBase, montoConIVA, \n          anticipoMonto, anticipoFecha \n        } = await request.json();\n\n        // CORREGIDO: Usar los nombres de columna correctos de la base de datos\n        const result = await sql\`\n            UPDATE contratos SET \n              nombre = ${nombre}, \n              cliente = ${cliente}, \n              descripcion = ${descripcion}, \n              estado = ${estado}, \n              fecha_inicio = ${fechaInicio}, \n              fechafin = ${fechaFin}, \n              fecha_termino_estimada = ${fechaTerminoEstimada}, \n              monto_base = ${montoBase}, \n              monto_total = ${montoConIVA}, \n              anticipo_monto = ${anticipoMonto}, \n              anticipo_fecha = ${anticipoFecha}\n            WHERE id = ${id} RETURNING *;\n        \`;\n\n        if (result.rows.length === 0) {\n            return NextResponse.json({ error: \'Contract not found\' }, { status: 404 });\n        }\n\n        return NextResponse.json({ contrato: result.rows[0] });\n\n    } catch (error) {\n        console.error(\'Error updating contract:\', error);\n        return NextResponse.json({ error: (error as Error).message }, { status: 500 });\n    }\n}\n\nexport async function DELETE(request: Request, { params }: { params: { id: string } }) {\n  try {\n    const { id } = params;\n    const result = await sql`DELETE FROM contratos WHERE id = ${id} RETURNING *;`;\n    if (result.rows.length === 0) {\n      return NextResponse.json({ error: \'Contract not found\' }, { status: 404 });\n    }\n    return NextResponse.json({ message: \'Contract deleted successfully\' });\n  } catch (error) {\n    console.error(\'Error deleting contract:\', error);\n    return NextResponse.json({ error: (error as Error).message }, { status: 500 });\n  }\n}\n